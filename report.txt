Assignment 1 Report By Yongchun Li, Yuxin Ren
Task1:
    Please see the drawio svg.
Task2:
    使用STRIDE方法论对VeriLens系统进行潜在安全威胁分析：

分析假设：
本次分析基于以下关键假设：
1. VeriLens系统采用基于云的分布式架构，各组件部署在不同的信任边界中
2. 系统使用第三方身份提供商(IdP)进行用户认证
3. 基于API的访问模式同时支持Web界面和付费用户的程序化访问
4. 系统处理和存储敏感媒体内容，特别是来自新闻媒体和政府机构的用户

S（假冒，Spoofing）类威胁：
1. 第三方身份提供商(IdP)假冒攻击
   a) 潜在攻击者：恶意网络攻击者
   b) 安全目标：身份认证
   c) 攻击方式：攻击者建立虚假的身份提供商服务，诱导用户在重定向过程中向假冒IdP提供凭证。当Web应用将用户重定向至身份验证流程时，攻击者可通过DNS劫持或钓鱼攻击将流量引导至伪造的IdP界面，从而窃取用户的身份凭证并获取访问令牌。
   d) 受影响组件：Web应用与第三方IdP之间的通信通道；Web应用程序信任边界与IdP信任边界之间的交互点。
   e) 相关案例/假设：此类攻击在2020年的SolarWinds事件中出现，攻击者伪造了SAML认证服务，成功创建伪造令牌[1]。我们假设VeriLens使用OAuth或SAML等标准协议进行认证重定向，这些协议在重定向过程中可能被DNS劫持或中间人攻击利用。

2. 认证令牌窃取与重放攻击
   a) 潜在攻击者：网络窃听者、XSS攻击者
   b) 安全目标：身份认证、会话完整性
   c) 攻击方式：攻击者通过网络嗅探、中间人攻击或客户端漏洞（如XSS）获取用户成功认证后IdP返回给Web应用的认证令牌。一旦窃取，攻击者可重放此令牌，从Web应用程序到身份验证服务的通信通道中冒充合法用户，访问他们的账户及提交的媒体文件。
   d) 受影响组件：IdP与Web应用程序之间的通信通道；用户浏览器环境；Web应用程序的会话管理系统。
   e) 相关案例/假设：2018年，Facebook API认证令牌被黑客窃取，影响了5000万用户账户[2]。我们假设VeriLens存储认证令牌的方式可能易受XSS攻击，特别是在未正确实施HttpOnly和Secure cookie标志或使用localStorage存储敏感令牌的情况下。

3. 付费API访问凭证假冒
   a) 潜在攻击者：竞争对手、恶意第三方开发者
   b) 安全目标：认证、授权
   c) 攻击方式：攻击者通过逆向工程或监控网络流量获取付费用户的API密钥/访问令牌，随后使用这些凭证通过VeriLens的API网关向验证处理后端发送请求，绕过付费限制并获取媒体验证服务。
   d) 受影响组件：API网关；Web应用程序与API网关之间的通信通道；付费用户与系统的信任边界。
   e) 相关案例/假设：2023年，几家主要AI公司如OpenAI和Anthropic的API密钥在GitHub上泄露，导致大量未授权调用[3]。我们假设VeriLens使用基于API密钥的认证模式，且这些密钥需要在客户端应用中使用，增加了泄露风险。

T（篡改，Tampering）类威胁：
4. 上传媒体文件篡改
   a) 潜在攻击者：恶意用户、反取证专家
   b) 安全目标：数据完整性
   c) 攻击方式：攻击者在文件从Web界面传输到验证处理后端的过程中，通过中间人攻击或利用上传验证漏洞，篡改待验证的媒体文件。这可能导致AI模型分析不准确的文件版本，从而影响验证结果的可靠性。
   d) 受影响组件：Web界面与验证处理后端之间的通信通道；数据传输层。
   e) 相关案例/假设：2022年，研究人员发现部分媒体检测系统在文件传输过程中缺乏完整性验证[4]。我们假设VeriLens在处理用户上传的媒体文件时，通信通道可能不使用端到端加密或缺乏有效的完整性验证机制。

5. 验证结果篡改
   a) 潜在攻击者：内部威胁、深度伪造发布者
   b) 安全目标：数据完整性、可靠性
   c) 攻击方式：攻击者在验证结果从AI处理后端传回Web界面或写入数据库的过程中拦截并修改信息，将低信任度的媒体文件（可能是深度伪造）篡改为高信任度结果。
   d) 受影响组件：AI处理后端与Web界面之间的通信通道；AI处理后端与数据库之间的数据流；验证结果存储系统。
   e) 相关案例/假设：2019年，Imperva数据库防火墙审计被绕过，导致内部数据篡改未被检测[5]。我们假设VeriLens的验证结果在不同组件间传输时可能缺乏数字签名或加密保护，特别是内部网络被认为"可信"的情况下。

6. 处理队列优先级篡改
   a) 潜在攻击者：不满的用户、系统内部人员
   b) 安全目标：公平访问、服务完整性
   c) 攻击方式：攻击者修改处理队列中的请求优先级信息，使免费用户的任务获得付费用户的处理优先权，或通过操纵队列数据导致某些验证请求被跳过或重复处理。
   d) 受影响组件：Web应用与验证后端之间的队列管理系统；任务调度系统；优先级数据流。
   e) 相关案例/假设：2021年，研究人员发现AWS SQS队列在特定配置下容易受到优先级操纵[6]。我们假设VeriLens使用类似RabbitMQ或Kafka的消息队列系统来管理处理任务，而这些系统如果配置不当，可能允许未经授权的优先级修改。

R（抵赖，Repudiation）类威胁：
7. 上传非法或有害媒体内容后抵赖
   a) 潜在攻击者：恶意用户、内容违规者
   b) 安全目标：不可抵赖性、责任追溯
   c) 攻击方式：用户上传非法或有害媒体内容（如虚假新闻材料）进行验证后，通过伪造请求来源或删除客户端日志来否认曾经上传过这些内容，使系统无法确认谁是违规媒体的来源。
   d) 受影响组件：Web界面的日志系统；用户活动跟踪系统；VeriLens数据库中的用户活动记录。
   e) 相关案例/假设：2021年，社交媒体平台上的用户通过代理或临时账户上传违规内容后否认责任，平台无法提供确凿证据[7]。我们假设VeriLens的日志系统可能未实现防篡改机制，且用户操作的日志可能只存储用户ID而非更强的身份证明。

8. 验证结果修改抵赖
   a) 潜在攻击者：内部管理员、系统操作员
   b) 安全目标：管理员操作不可抵赖性、审计完整性
   c) 攻击方式：内部管理员通过直接访问数据库修改特定媒体文件的验证结果（例如，将明显的深度伪造媒体的低信任度分数提高），随后删除或修改系统日志以消除这些操作的痕迹。
   d) 受影响组件：管理员访问控制系统；数据库操作日志；系统审计跟踪；管理员工作站与数据库服务器之间的通信通道。
   e) 相关案例/假设：2020年，特权账户滥用导致多家企业内部数据操纵事件，管理员成功删除审计日志[8]。我们假设VeriLens允许管理员通过特权访问工作站直接访问数据库，且日志系统未实现分离存储或防篡改机制。

9. 付费交易抵赖
   a) 潜在攻击者：付费订阅用户
   b) 安全目标：业务交易不可抵赖性、财务完整性
   c) 攻击方式：用户使用VeriLens付费服务后，通过向信用卡公司或支付服务提出争议，声称未授权该交易。由于缺乏交易授权的可靠证据，VeriLens与第三方支付服务之间的通信可能无法证明用户确实授权了该交易。
   d) 受影响组件：Web应用与第三方计费服务之间的通信通道；支付认证系统；交易记录数据库。
   e) 相关案例/假设：2022年，数字服务提供商面临"友好欺诈"(friendly fraud)增长，用户购买服务后提出欺诈性付款争议[9]。我们假设VeriLens使用第三方支付处理服务，可能缺乏强有力的交易授权证明，如生物认证记录或多因素认证日志。

I（信息泄露，Information Disclosure）类威胁：
10. 用户提交媒体内容泄露
    a) 潜在攻击者：内部员工、数据库攻击者
    b) 安全目标：数据保密性、用户隐私
    c) 攻击方式：攻击者通过SQL注入或利用数据库访问控制不当，从VeriLens的中央数据库中提取用户上传的媒体文件，特别是新闻机构或政府用户提交的敏感或未公开的媒体内容。
    d) 受影响组件：中央数据库服务器；数据库访问控制机制；Web应用程序与数据库之间的查询通道。
    e) 相关案例/假设：2021年，Parler社交媒体平台遭遇大规模数据泄露，攻击者利用API漏洞提取了包括未公开媒体内容在内的70TB数据[10]。我们假设VeriLens存储用户上传的媒体内容用于审计或比对目的，且这些数据可能在数据库中以非加密形式存储。

11. 验证算法和判断标准泄露
    a) 潜在攻击者：竞争对手、反取证研究人员
    b) 安全目标：知识产权保密性、算法安全
    c) 攻击方式：攻击者通过分析API响应或错误消息中的详细技术信息，推断VeriLens使用的深度伪造检测算法和判断标准。这些信息可能通过验证后端到Web界面的通信通道中的过度详细错误消息或调试信息泄露。
    d) 受影响组件：AI处理后端；API响应格式化服务；错误处理系统；验证后端与Web界面之间的通信通道。
    e) 相关案例/假设：2019年，研究人员通过黑盒测试和系统性输入变化成功逆向工程了多个商业AI决策系统的核心算法[11]。我们假设VeriLens的API和Web界面在错误处理过程中可能返回过于详细的技术信息，包括模型参数或判断依据。

12. 用户使用模式和敏感查询泄露
    a) 潜在攻击者：网络监听者、流量分析者
    b) 安全目标：元数据保密性、用户行为隐私
    c) 攻击方式：即使通信内容加密，攻击者也可通过监控Web界面与验证后端或数据库之间的通信模式、频率和数据量，分析哪些用户（特别是新闻机构或政府机构）正在大量验证媒体内容，从而推断可能的敏感新闻调查或政府行动。
    d) 受影响组件：所有系统组件之间的网络通信通道；通信元数据；流量模式。
    e) 相关案例/假设：2013年，NSA棱镜计划利用流量分析技术推断用户行为模式，即使无法解密通信内容[12]。我们假设VeriLens的通信虽经TLS加密，但未采用流量填充或其他反流量分析技术，使通信模式和数量仍可被外部观察。

D（拒绝服务，Denial of Service）类威胁：
13. 验证处理队列饱和攻击
    a) 潜在攻击者：竞争对手、服务破坏者
    b) 安全目标：系统可用性、服务质量
    c) 攻击方式：攻击者创建多个免费账户，通过Web界面向处理队列提交大量复杂媒体文件，耗尽AI处理资源并导致队列饱和，使合法用户（尤其是关键时刻需要验证服务的新闻机构）无法及时获得验证结果。
    d) 受影响组件：Web界面的速率限制机制；验证处理队列；AI处理后端资源分配系统；Web界面与验证后端之间的通信通道。
    e) 相关案例/假设：2020年，多家AI服务提供商如OpenAI和Google遭遇资源耗尽攻击，攻击者利用免费API额度进行大规模并发请求[13]。我们假设VeriLens对免费用户的请求速率限制基于账户级别，而非IP地址或设备指纹，使攻击者可创建多个账户绕过限制。

14. AI模型资源耗尽攻击
    a) 潜在攻击者：深度伪造创建者、系统漏洞利用者
    b) 安全目标：计算资源可用性、处理效率
    c) 攻击方式：攻击者精心设计特殊媒体文件，这些文件在分析过程中会导致深度伪造检测模型消耗异常高的计算资源或陷入处理循环。通过Web界面或API提交这些恶意设计的文件，可能导致验证后端GPU资源耗尽，影响整体服务响应能力。
    d) 受影响组件：AI处理后端；GPU计算资源；模型执行环境；文件预处理系统。
    e) 相关案例/假设：2023年，研究人员发现针对图像识别AI的"神经网络毒丸"(neural network poison pills)，可导致模型处理时间增加50-100倍[14]。我们假设VeriLens的深度伪造检测模型可能缺乏资源消耗监控和异常处理机制，特别是在处理高度复杂或专门设计的对抗性媒体文件时。

15. 第三方依赖服务中断攻击
    a) 潜在攻击者：基础设施攻击者、DDoS攻击者
    b) 安全目标：服务连续性、外部依赖可靠性
    c) 攻击方式：攻击者针对VeriLens依赖的关键第三方服务（如身份提供商或计费服务）发起DDoS攻击，中断这些服务的可用性。由于Web应用程序需要与这些服务进行实时通信来处理认证或付款，中断这些外部服务可能导致VeriLens的核心功能无法访问。
    d) 受影响组件：第三方IdP服务；Web应用与IdP之间的通信通道；第三方计费服务；跨信任边界的通信点。
    e) 相关案例/假设：2021年，AWS身份服务中断导致依赖其认证的多个SaaS平台无法提供服务超过3小时[15]。我们假设VeriLens严重依赖第三方IdP进行认证，且未实现本地降级认证机制或服务中断备用流程。

E（提升权限，Elevation of Privilege）类威胁：
16. 从免费用户到付费用户功能的未授权访问
    a) 潜在攻击者：免费用户、服务滥用者
    b) 安全目标：授权控制、服务等级隔离
    c) 攻击方式：攻击者操纵从Web界面发送到验证后端的请求参数，修改用户权限标识符或绕过前端访问控制检查，使免费账户能够访问付费用户专属功能，如批量处理或详细分析报告，而无需支付费用。
    d) 受影响组件：Web界面的授权检查机制；Web界面与验证后端之间的请求通道；用户权限管理系统。
    e) 相关案例/假设：2019年，Spotify Premium功能被发现可通过修改API请求参数获取免费访问[16]。我们假设VeriLens仅在前端界面实施服务层级检查，而未在后端验证或在不同系统组件之间未正确传递并验证用户权限级别。

17. 管理员账户接管
    a) 潜在攻击者：外部黑客、内部低权限用户
    b) 安全目标：权限分离、管理访问控制
    c) 攻击方式：攻击者通过利用管理员工作站的安全漏洞或通过钓鱼获取管理员凭证，访问管理员专用界面，从而获得直接操作数据库、配置系统参数或访问其他用户数据的能力。
    d) 受影响组件：管理员工作站；管理员认证系统；公司内部网络与管理界面之间的通信通道；管理员信任边界。
    e) 相关案例/假设：2020年Twitter员工账户被社会工程学攻击者接管，导致高知名度账户被控制[17]。我们假设VeriLens的管理员可能从内部网络或通过VPN远程访问管理界面，且这些账户可能未配置强制多因素认证。

18. API访问控制绕过
    a) 潜在攻击者：安全研究人员、未授权开发者
    b) 安全目标：API安全、访问控制
    c) 攻击方式：攻击者分析付费用户API端点的访问控制机制，发现实现缺陷或逻辑漏洞，允许构造特殊请求绕过API网关的权限验证，直接向验证处理后端发送未经授权的处理请求。
    d) 受影响组件：API网关；访问控制实施点；API网关与验证后端之间的通信通道；授权验证机制。
    e) 相关案例/假设：2021年，研究人员在多个API网关产品中发现了访问控制绕过漏洞，包括JWT验证不当和路径遍历缺陷[18]。我们假设VeriLens使用API网关产品(如Kong或AWS API Gateway)进行授权检查，这些产品如配置不当可能被绕过。

19. 云基础设施权限提升
    a) 潜在攻击者：云服务供应商内部人员、高级持续性威胁(APT)攻击者
    b) 安全目标：多租户隔离、基础设施安全
    c) 攻击方式：攻击者利用云服务中的虚拟机逃逸漏洞或配置错误，从同一物理服务器上的其他租户突破隔离，获取对VeriLens验证后端服务器或数据库服务器的底层访问权限，进而访问或修改敏感数据。
    d) 受影响组件：云服务提供商的虚拟化层；服务器主机环境；验证后端与数据库服务器之间的信任边界；云基础设施控制平面。
    e) 相关案例/假设：2019年，研究人员在英特尔CPU中发现MDS(微架构数据采样)漏洞，使不同虚拟机间的隔离被突破[19]。我们假设VeriLens在公共云环境中部署多个组件，且依赖云服务提供商的默认隔离机制而非额外的应用层加密或完整性保护。

20. 数据库权限提升
    a) 潜在攻击者：数据库操作员、内部低权限技术人员
    b) 安全目标：数据访问控制、最小权限原则
    c) 攻击方式：数据库运维人员利用数据库管理系统中的提权漏洞或配置错误，提升其访问权限从只读查询到管理员级别，从而能够修改用户验证历史、删除审计日志或提取全部用户数据。
    d) 受影响组件：中央数据库服务器；数据库权限管理系统；数据库管理接口；数据库与Web应用程序/验证后端之间的通信通道。
    e) 相关案例/假设：2021年，MongoDB和PostgreSQL中发现了多个权限提升漏洞，允许只读用户获取更高权限[20]。我们假设VeriLens使用这些流行的数据库系统，且定期的补丁管理可能不及时，特别是对于非关键安全更新。

参考资料:
[1] CISA, "Advanced Persistent Threat Compromise of Government Agencies...", 2020
[2] Facebook, "Security Update - Reset Access Tokens", 2018
[3] CheckPoint Research, "AI API Key Leaks: Risks and Mitigation", 2023
[4] Farid et al., "Security Issues in Media Validation Pipelines", IEEE, 2022
[5] Imperva, "Security Incident: Update", 2019
[6] AWS Security Blog, "SQS Priority Queue Vulnerability", 2021
[7] TrendMicro, "Content Moderation Challenges", 2021
[8] Gartner, "Privileged Access Misuse Report", 2020
[9] Chargebacks911, "Digital Service Fraud Report", 2022
[10] Wired, "Parler Data Breach Exposes Millions of Posts", 2021
[11] Black Hat, "Breaking AI Model Security by Design", 2019
[12] EFF, "Metadata Analysis and NSA Surveillance", 2013
[13] CloudFlare, "AI Services Under Attack", 2020
[14] USENIX Security, "Adversarial Computation Exhaustion Attacks", 2023
[15] AWS, "Service Health Dashboard - 2021 Incidents", 2021
[16] HackerOne, "Spotify API Vulnerability Report", 2019
[17] Twitter, "Security Incident - July 2020", 2020
[18] OWASP API Security Top 10, "Broken Access Control Examples", 2021
[19] Intel Security Advisory, "Microarchitectural Data Sampling", 2019
[20] CVE Database, "Database Privilege Escalation Vulnerabilities", 2021
